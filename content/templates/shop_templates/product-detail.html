{% extends 'layouts/default/shopper_base2.html' %}
{% load static %}

{% load i18n %}
{% load bootstrap4 %}

{% block title %} <title>{% trans "Product Detail" %}</title> {% endblock %}
{% block head_link %}
    <!-- Favicons-->

    <link rel="icon" href="{% static 'favicon.ico' %}">
    {#    <link rel="shortcut icon" href="{% static "assets/img_for_shop/favicon.ico" %}" type="image/x-icon">#}
    <link rel="apple-touch-icon" type="image/x-icon"
          href="{% static "assets/img_for_shop/apple-touch-icon-57x57-precomposed.png" %}">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="72x72"
          href="{% static "assets/img_for_shop/apple-touch-icon-72x72-precomposed.png" %}">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="114x114"
          href="{% static "assets/img_for_shop/apple-touch-icon-114x114-precomposed.png" %}">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="144x144"
          href="{% static "assets/img_for_shop/apple-touch-icon-144x144-precomposed.png" %}">

    <!-- GOOGLE WEB FONT -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

    <link href="{% static 'assets/font-awesome/fontawesome-free-5.15.4-web/css/all.css' %}" rel="stylesheet">

    <!-- BASE CSS -->
    <link href="{% static "assets/css_for_shop/bootstrap.custom.min.css" %}" rel="stylesheet">
    <link href="{% static "assets/css_for_shop/style.css" %}" rel="stylesheet">

    <!-- SPECIFIC CSS -->
    <link href="{% static "assets/css_for_shop/product_page.css" %}" rel="stylesheet">


    <!-- YOUR CUSTOM CSS -->
    <link href="{% static "assets/css_for_shop/custom.css" %}" rel="stylesheet">

    <style>
        .container-v3 {
            max-width: 1420px;
        }

        .wrapper-hidden {
            display: none;
        }

        .slider-two .owl-stage {
            display: flex !important;
            flex-direction: column;
        }

        .slider-two .owl-item {
            margin-bottom: 9px;
        }

        .slider-two .owl-stage .active {
            border: wheat;
            border-style: solid;
        }

        .slider-two {
            width: 500% !important;
        }

        .tab-pd-details {
            margin-top: 2%;
        }

        {% if model_url == "none" %}
            .show3D {
                display: none !important;
            }
        {% else %}

        {% endif %}
    </style>

{% endblock %}


{% block content %}
    <main>
        <div class="wrap-bread-crumb">
            <div class="container container-v3">
                <div class="row">
                    <div class="col-sm-6">
                        <!-- /snippets/breadcrumb.liquid -->
                        <div class="bread-crumb">
                            <a href="/" title="Back to the frontpage">{% trans 'Home' %}<i class="fa fa-angle-right"
                                                                                           aria-hidden="true"></i></a>
{#                            <a href="/collections/hot-deal">{% trans 'hot deal' %} <i class="fa fa-angle-right"#}
{#                                                                                      aria-hidden="true"></i></a>#}
                            <strong>{% trans 'YC Combo Organ' %}</strong>

                        </div>
                    </div>
                    <div class="col-sm-6 justify-content-end align-items-center d-sm-flex d-none prod_extended">
                        <div class="arrows-product">
                            <div class="prev_prod">
                                <a href="/product_details/{{ prev_instrument.id }}">
                                    {% trans "Prev" %}<i class="fa fa-angle-left" aria-hidden="true"></i>
                                </a>
                                <div class="position-absolute img-prev">
                                    <a href="/product_details/{{ prev_instrument.id }}">
                                        <img src="{{ prev_instrument.image.url }}" style="width: 70px;"
                                             class="">
                                    </a>
                                    <div class="info-prod">
                                        <a href="/product_details/{{ prev_instrument.image.url }}">{% trans prev_instrument.name %}</a>
                                        <p>${{ prev_instrument.price }}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="next_prod">
                                <a href="/product_details/{{ next_instrument.id }}">
                                    Next<i class="fa fa-angle-right" aria-hidden="true"></i>
                                </a>
                                <div class=" img-next">
                                    <a href="/product_details/{{ next_instrument.id }}">
                                        <img src="{{ next_instrument.image.url }}" style="width: 70px;"
                                             class="">
                                    </a>
                                    <div class="info-prod">
                                        <a href="/product_details/{{ next_instrument.id }}">{% trans next_instrument.name %}</a>
                                        <p>${{ next_instrument.price }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container  container-v3">
            <div class="row">
                <div class="col-md-5">
                    <div class="row">
                        <div class="col-md-2">
                            <div class="slider-two">
                                <div class="owl-carousel owl-carousel-vertical owl-theme thumbs vertical-slider">
                                    <div>
                                        <img class="item active"
                                             src="{{ instrument.image.url }}"
                                             alt="">
                                    </div>
                                    <div>
                                        <img class="item active"
                                             src="{{ instrument.image1.url }}"
                                             alt="">
                                    </div>
                                    {% if instrument.image2.url != "/media/default.jpg" %}
                                        <div>
                                            <img class="item active"
                                                 src="{{ instrument.image2.url }}"
                                                 alt="">
                                        </div>
                                    {% endif %}
                                    {% if instrument.image3.url != "/media/default.jpg" %}
                                        <div>
                                            <img class="item active"
                                                 src="{{ instrument.image3.url }}"
                                                 alt="">
                                        </div>
                                    {% endif %}
                                    {% if instrument.image4.url  != "/media/default.jpg" %}
                                        <div>
                                            <img class="item active"
                                                 src="{{ instrument.image4.url }}"
                                                 alt="">
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="left-t nonl-t"></div>
                                <div class="right-t"></div>
                            </div>
                        </div>
                        <div class="col-md-10">
                            <div class="all">
                                <div class="show3D"
                                     style="cursor:pointer;right: 5%; position: absolute; z-index: 3; background: white; width: 10%; height: 10%; box-shadow: 0 1px 2px 0 #a1aaad; border-radius: 50%; top: 5%;">
                                    <img style="padding: 18%;width: 100%" id="3d-icon"
                                         src="{% static "assets/img_for_shop/3d-icon.png" %}">
                                </div>
                                <div class="show-controls wrapper-hidden"
                                     style="bottom: 0;position: absolute;z-index:3;width:5%">
                                    <div class="model-zoom-in">
                                        <img style="width: 100%;cursor:pointer;margin-bottom: 5px;"
                                             src="{% static "assets/img_for_shop/3d-zoom-out.svg" %}">
                                    </div>
                                    <div class="model-zoom-out">
                                        <img style="width: 100%;cursor:pointer;margin-bottom: 5px;"
                                             src="{% static "assets/img_for_shop/3d-zoom-in.svg" %}">
                                    </div>
                                    <div onclick=switchRotate()>
                                        <img style="width: 100%;cursor:pointer"
                                             src="{% static "assets/img_for_shop/3d-rotate.svg" %}">
                                    </div>
                                </div>
                                <!--加载模型，默认不显示  -->
                                <div id="progress" class="progress" style="display:none;">
                                </div>
                                <div class="slider">
                                    <div class="owl-carousel owl-theme main">
                                        <div>
                                            <img class="owl-lazy"
                                                 src="{{ instrument.image.url }}"
                                                 data-src="/media/uploads/instrument/image/detail_piano1 (1).jpg" alt=""
                                                 style="opacity: 1;">
                                        </div>
                                        <div>
                                            <img class="owl-lazy"
                                                 src="{{ instrument.image1.url }}"
                                                 data-src="/media/uploads/instrument/image/detail_piano1 (2).jpg" alt=""
                                                 style="opacity: 1;">
                                        </div>
                                        {% if instrument.image2.url  != "/media/default.jpg" %}
                                            <div>
                                                <img class="owl-lazy"
                                                     src="{{ instrument.image2.url }}"
                                                     data-src="/media/uploads/instrument/image/detail_piano1 (3).jpg"
                                                     alt=""
                                                     style="opacity: 1;">
                                            </div>
                                        {% endif %}
                                        {% if instrument.image3.url  != "/media/default.jpg" %}
                                            <div>
                                                <img class="owl-lazy"
                                                     src="{{ instrument.image3.url }}"
                                                     data-src="/media/uploads/instrument/image/detail_piano1 (4).jpg"
                                                     alt=""
                                                     style="opacity: 1;">
                                            </div>
                                        {% endif %}
                                        {% if instrument.image4.url  != "/media/default.jpg" %}
                                            <div>
                                                <img class="owl-lazy"
                                                     src="{{ instrument.image4.url }}"
                                                     data-src="/media/uploads/instrument/image/detail_piano1 (5).jpg"
                                                     alt=""
                                                     style="opacity: 1;">
                                            </div>
                                        {% endif %}
                                    </div>
                                    <div class="left nonl"><i class="ti-angle-left"></i></div>
                                    <div class="right"><i class="ti-angle-right"></i></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="detail-info">
                        <h2 class="product-title">{% trans instrument.name %}</h2>
                        <div class="product-price ">
                            <del class="enj-product-price-compare">${{ instrument.old_price }} </del>
                            <ins class="enj-product-price engoj_price_main">${{ instrument.price }} </ins>
                        </div>
                        <div class="wrap-rating">
                            <span class="spr-badge">
                                <span class="spr-starrating spr-badge-starrating">
                                    <i class="spr-icon fa fa-star" aria-hidden="true"></i>
                                    <i class="spr-icon fa fa-star" aria-hidden="true"></i>
                                    <i class="spr-icon spr-icon-star-empty fa fa-star" aria-hidden="true"></i>
                                    <i class="spr-icon spr-icon-star-empty fa fa-star" aria-hidden="true"></i>
                                    <i class="spr-icon spr-icon-star-empty fa fa-star" aria-hidden="true"></i>
{#                                    <i class="spr-icon spr-icon-star-empty" aria-hidden="true"></i><i#}
{#                                        class="spr-icon spr-icon-star-empty" aria-hidden="true"></i><i#}
{#                                        class="spr-icon spr-icon-star-empty" aria-hidden="true"></i><i#}
{#                                        class="spr-icon spr-icon-star-empty" aria-hidden="true"></i><i#}
{#                                        class="spr-icon spr-icon-star-empty" aria-hidden="true"></i></span>#}
                                <span class="spr-badge-caption">{% trans 'No reviews' %}</span>
                                </span>
                            </span>
                        </div>
                        <div class="pd_summary">
                            <p class=" mb-0">{% trans instrument.details|truncatechars:370 %}</p>
                        </div>
                        <form method="post" enctype="multipart/form-data" id="AddToCartForm"
                              class="cart clearfix mt-3">
                            {% csrf_token %}
                            <input type="hidden" value="{{ instrument.id }}" name="product-id">
                            <div class="selector-wrapper"><label
                                    for="productSelect-option-0">{% trans "Color" %}</label><select
                                <div class="selector-wrapper"><label
                                        for="productSelect-option-0">{% trans "Color" %}</label><select
                                        class="single-option-selector" data-option="option1"
                                        id="productSelect-option-0">
                                    <option value="Maroon">{% trans 'Maroon' %}</option>
                                    <option value="White">{% trans 'White' %}</option>
                                </select></div>
                                <select name="id" id="productSelect" class="product-single__variants"
                                        style="display: none;">
                                    <option selected="selected" data-sku=""
                                            value="37685248721083">{% trans 'Maroon - $223.00 USD' %}
                                    </option>
                                    <option data-sku=""
                                            value="37685248753851">{% trans 'White - $223.00 USD' %}</option>
                                </select>
                                <!--Swatch Variant -->

                                {#                            <div class="maxus-productdetail__options">#}
                                {#                                <div class="swatch clearfix  align-center flex engoc-flex-wrap" data-option-index="0">#}
                                {#                                    <p class="text-uppercase title_variant">{% trans "Color " %}</p>#}
                                {#                                    <p class="text-uppercase title_variant">{% trans "Color " %}</p>#}
                                {#                                    <div data-value="Maroon" data-style="square"#}
                                {#                                         class="maxus-color none color maroon available">#}
                                {#                                        <input id="swatch-0-maroon" type="radio" name="option-0" value="Maroon"#}
                                {#                                               checked="">#}
                                {#                                        <div class="  border-color ">#}
                                {#                                            <label class="link_color" for="swatch-0-maroon"#}
                                {#                                                   style="background-color: maroon; background-image: url(//cdn.shopify.com/s/files/1/0518/3173/4459/files/maroon.png?1155); background-size: cover;">#}
                                {#                                            </label>#}
                                {#                                        </div>#}
                                {#                                    </div>#}
                                {#                                    <div data-value="White" data-style="square"#}
                                {#                                         class="maxus-color none color white available">#}
                                {#                                        <input id="swatch-0-white" type="radio" name="option-0" value="White">#}
                                {#                                        <div class="  border-color ">#}
                                {#                                            <label class="link_color" for="swatch-0-white"#}
                                {#                                                   style="background-color: white; background-image: url(//cdn.shopify.com/s/files/1/0518/3173/4459/files/white.png?1155); background-size: cover;">#}
                                {#                                            </label>#}
                                {#                                        </div>#}
                                {#                                    </div>#}
                                {#                                </div>#}
                                {#                            </div>#}
                                {#                            <!--End Swatch Variant -->#}

                                <!-- Add to cart & quantity -->
                                <div class="btn-action detail-attr qty-cart">
                                    <div class="">
                                        <div class="js-qty">
                                            <button type="button"
                                                    class="qty_minus js-qty__adjust js-qty__adjust--minus icon-fallback-text"
                                                    data-id="" data-qty="0">
                                                <span class="fa fa-minus"></span>
                                            </button>
                                            <input type="text" class="js-qty__num" value="1" min="1" data-id=""
                                                   aria-label="quantity" pattern="[0-9]*" name="quantity" id="Quantity">
                                            <button type="button"
                                                    class="qty_plus js-qty__adjust js-qty__adjust--plus icon-fallback-text"
                                                    data-id="" data-qty="11">
                                                <span class="fa fa-plus"></span>
                                            </button>
                                        </div>
                                    </div>
                                    <button type="submit" class="shop-button enj-add-to-cart-btn engoj-btn-addtocart"
                                            value="Add to Cart" style="opacity: 1;">
                                        {% trans 'Add to Cart' %}
                                    </button>
                                </div>
                                <!-- End add to cart & quantity -->
                                <input type="hidden" name="form_type" value="product">
                                <input type="hidden" name="utf8" value="✓">
                                <div data-shopify="payment-button" data-has-selling-plan="false"
                                     class="shopify-payment-button">
                                    {% if instrument.quantity > 0 %}
                                    <button type="button"
                                            class="shopify-payment-button__button"
                                            data-testid="Checkout-button"
                                            onclick="window.location.href='{% url "shop:checkout_single_instrument" instrument_id=instrument.id %}'">
                                        {% trans 'Buy it now' %}
                                    </button>
                                    {% else %}
                                        <button type="button"
                                            class="shopify-payment-button__button"
                                            data-testid="Checkout-button"
                                            disabled="disabled">
                                        {% trans 'Empty Stock' %}
                                    </button>
                                    {% endif %}
                                </div>
                        </form>
                        <div class="btn-addwhlist" id="wishlist__{{ instrument.id }}">
                            <a href="javascript:void(0)"
                               class="box-shadow  inline-block maxus-product__wishlist wish text-center"
                               data-toggle="tooltip" data-placement="top" data-original-title="Add to Wishlist">
                                <i class="fsz-unset"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->
                                    <svg t="1651312217344" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                         xmlns="http://www.w3.org/2000/svg" p-id="6268" width="200" height="200">
                                        <path d="M512.433231 933.714708a148.243692 148.243692 0 0 1-68.017231-16.478523C310.799754 848.250092 0 657.486769 0 376.808369 0 206.170585 129.386338 67.339815 288.421415 67.339815c87.370831 0 169.314462 42.677169 223.578585 114.04997 54.264123-71.3728 136.207754-114.049969 223.578585-114.04997 159.035077 0 288.421415 138.830769 288.421415 309.476431 0 284.081231-310.768246 472.859569-444.384492 540.837416a148.212185 148.212185 0 0 1-67.182277 16.061046zM288.421415 130.3552C164.131446 130.3552 63.015385 240.915692 63.015385 376.808369c0 105.259323 52.8384 209.014154 157.042215 308.381539 90.112 85.937231 197.364185 147.196062 253.274585 176.057107a85.354338 85.354338 0 0 0 77.713723 0.244185c55.878892-28.427815 163.060185-88.914708 253.077661-174.607754C908.209231 587.783877 960.984615 483.461908 960.984615 376.808369c0-135.892677-101.116062-246.461046-225.40603-246.461046-80.541538 0-155.521969 47.592369-195.670647 124.219077a31.507692 31.507692 0 0 1-55.815876 0c-40.156554-76.618831-115.136985-124.2112-195.670647-124.2112z"
                                              fill="" p-id="6269"></path>
                                    </svg>
                                </i>
                            </a>
                            <span class="text_whlist"></span>
                        </div>
                        <ul class="product-meta-info">
                            <li>
                                <div class="item-product-meta-info product-category-info">
                                    <label>{% trans "Categories :" %}</label>
                                    <a href="/product_search/?category={{ instrument.category.id }}">{{ instrument.category.name }} </a>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <!-- /product_actions -->
                </div>
                <div class="col-lg-3 col-md-12 col-12">
                    <div class="row prod_extended">
                        {#                        <div class="col-lg-12 col-md-4 content-page-detail">#}
                        {#                            <div class="content_box ">#}
                        {#                                <div class="content_text">#}
                        {#                                    <h3 class="title">{% trans "Why Choose Us ?" %}</h3>#}
                        {#                                    <h3 class="title">{% trans "Why Choose Us ?" %}</h3>#}
                        {#                                    <div class="text">Official Herschel stockist Australian warranty assistance &amp;#}
                        {#                                        support Australian shipping &amp; returns.Customer first experience#}
                        {#                                        environmentally focused#}
                        {#                                    </div>#}
                        {#                                </div>#}
                        {#                            </div>#}
                        {#                        </div>#}
                        <div class="col-lg-12 col-md-4 content-page-detail">
                            <div class="content_box ">
                                <div class="content_text">
                                    <h3 class="title">{% trans 'Returns' %}</h3>
                                    <div class="text">{% trans 'Return this product within 100 days if you change your mind. Get a refund/replacement &amp; free return shipping if it arrives damaged or not as described' %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12 col-md-4 content-page-detail">
                            <div class="content_box ">
                                <div class="content_text">
                                    <h3 class="title">{% trans 'Shipping' %}</h3>
                                    <div class="text">{% trans 'Free if stated near price. $9.95 Australia wide (up to 10 items). $18.95 for Express Post (generally 1 business day).' %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /row -->
        </div>
        <!-- /container -->

        <div class="tab-pd-details">
            <div class="bd-tab">
                <div class="container container-v3">
                    <ul class="nav nav-tabs tab_prod">
                        <li>
                            <a class="underline_scale active" data-toggle="tab"
                               href="#des">{% trans 'Description' %}</a>
                        </li>
                        <li>
                            <a class="underline_scale" data-toggle="tab"
                               href="#add">{% trans 'Additional Information' %}</a>
                        </li>
                        <li>
                            <a class="underline_scale" data-toggle="tab" href="#review">{% trans 'Review' %}</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="tab-content container container-v3">
                <div class="tab-pane show active" id="des">
                    <div class="desc product-desc"><p>
                        {{ instrument.ex_detail }}
                    </p>
                    </div>
                </div>
                <div class="tab-pane tab-addition" id="add">
                    <div class="">
                        <div class="row justify-content-center">
                            <div class="col-lg-8 col-md-6">
                                <div class="title_content">
                                    <p class="more_info">{% trans 'More Infomation To You' %}</p>
                                    <h3 class="">{% trans 'Things you need to know' %}</h3>
                                </div>
                                <div class="desc product-desc"><p>
                                    {% trans instrument.ad_info %}
                                </p>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-6">
                                <img style="width: 100%"
                                     src="{{ instrument.image1.url }}">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane mt-4" id="review">
                    <div class="container" id="shopify-product-reviews">
                        {#                        <div id="collapse-B" class="collapse" role="tabpanel" aria-labelledby="heading-B">#}
                        <div class="card-body" style="text-align: start;">
                            <div class="row justify-content-between">
                                {% for review in review_left %}
                                    <div class="col-lg-6">
                                        <div class="review_content">
                                            <div class="clearfix add_bottom_10">
                                                <span class="rating">
                                                    {% for iter in review.review_icon_iter %}
                                                        <i class="icon-star"></i>
                                                    {% endfor %}
                                                    {% for iter in review.review_icon_iter2 %}
                                                        <i class="icon-star-empty"></i>
                                                    {% endfor %}
                                                    <em>{{ review.rating }}/5.0</em></span>
                                                <em>{{ review.created_at }}</em>
                                            </div>
                                            <h4>"{% trans review.title %}"</h4>
                                            <p>{% trans review.content %}</p>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                            <!-- /row -->
                            <div class="row justify-content-between">
                                {% for review in review_right %}
                                    <div class="col-lg-6">
                                        <div class="review_content">
                                            <div class="clearfix add_bottom_10">
                                                <span class="rating">
                                                    {% for iter in review.review_icon_iter %}
                                                        <i class="icon-star"></i>
                                                    {% endfor %}
                                                    {% for iter in review.review_icon_iter2 %}
                                                        <i class="icon-star-empty"></i>
                                                    {% endfor %}

                                                    <em>{{ review.rating }}/5.0</em></span>
                                                <em>{{ review.created_at }}</em>
                                            </div>
                                            <h4>{% trans review.title %}</h4>
                                            <p>{% trans review.content %}</p>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                            <!-- /row -->
                            <p class="text-end"><a href="{% url 'shop:leave_review' instrument.id %}"
                                                   class="btn_1">{% trans "Leave a review" %}</a></p>
                        </div>
                        <!-- /card-body -->
                        {#                        </div>#}
                    </div>
                </div>
            </div>
        </div>

        <div class="container margin_60_35">
            <div class="main_title">
                <h2>{% trans "Related" %}</h2>
                <span>{% trans "Products" %}</span>
            </div>
            <div class="owl-carousel owl-theme products_carousel">
                {% for item in related %}
                    <div class="item">
                        <div class="grid_item">
                            <span class="ribbon new">{% trans 'New' %}</span>
                            <figure>
                                <a href="{% url 'shop:product_details' product_id=item.id %}">
                                    <img class="owl-lazy image-size" src="/media/{{ item.image }}"
                                         data-src="/media/{{ item.image }}" alt="">
                                </a>
                            </figure>
                            <div class="rating"><i class="icon-star voted"></i><i class="icon-star voted"></i><i
                                    class="icon-star voted"></i><i class="icon-star voted"></i><i class="icon-star"></i>
                            </div>
                            <a href="{% url 'shop:product_details' product_id=item.id %}">
                                <h3>{% trans item.name %}</h3>
                            </a>
                            <div class="price_box">
                                <span class="new_price">${{ item.price }}</span>
                            </div>
                            <ul>
                                <li><a href="javascript:void(0)" class="tooltip-1 related-add-wishlist"
                                       data-bs-toggle="tooltip" data-bs-placement="left"
                                       title="Add to favorites" id="wishlist__{{ item.id }}"><i
                                        class="ti-heart"></i><span>{% trans 'Add to favorites' %}</span></a></li>
                                {#                                <li><a href="#0" class="tooltip-1" data-bs-toggle="tooltip" data-bs-placement="left"#}
                                {#                                       title="Add to compare"><i#}
                                {#                                        class="ti-control-shuffle"></i><span>{% trans 'Add to compare' %}</span></a>#}
                                {#                                </li>#}
                                <li><a href="javascript:void(0)" class="tooltip-1 related-add-cart"
                                       data-bs-toggle="tooltip" data-bs-placement="left"
                                       title="Add to cart" id="cart__{{ item.id }}"><i
                                        class="ti-shopping-cart"></i><span>{% trans 'Add to cart' %}</span></a>
                                </li>
                            </ul>
                        </div>
                        <!-- /grid_item -->
                    </div>
                    <!-- /item -->
                {% endfor %}
            </div>
            <!-- /products_carousel -->
        </div>
        <!-- /container -->

    </main>
    <!-- /main -->

    {#    <footer class="revealed">#}
    {#        <div class="container">#}
    {#            <div class="row">#}
    {#                <div class="col-lg-3 col-md-6">#}
    {#                    <h3 data-bs-target="#collapse_1">{% trans 'Quick Links' %}</h3>#}
    {#                    <div class="collapse dont-collapse-sm links" id="collapse_1">#}
    {#                        <ul>#}
    {#                            <li><a href="about.html">{% trans 'About us' %}</a></li>#}
    {#                            <li><a href="help.html">{% trans 'Faq' %}</a></li>#}
    {#                            <li><a href="help.html">{% trans 'Help' %}</a></li>#}
    {#                            <li><a href="account.html">{% trans 'My account' %}</a></li>#}
    {#                            <li><a href="blog.html">{% trans 'Blog' %}</a></li>#}
    {#                            <li><a href="contacts.html">{% trans 'Contacts' %}</a></li>#}
    {#                        </ul>#}
    {#                    </div>#}
    {#                </div>#}
    {#                <div class="col-lg-3 col-md-6">#}
    {#                    <h3 data-bs-target="#collapse_2">{% trans 'Categories' %}</h3>#}
    {#                    <div class="collapse dont-collapse-sm links" id="collapse_2">#}
    {#                        <ul>#}
    {#                            <li><a href="listing-grid-1-full.html">{% trans 'Clothes' %}</a></li>#}
    {#                            <li><a href="listing-grid-2-full.html">{% trans 'Electronics' %}</a></li>#}
    {#                            <li><a href="listing-grid-1-full.html">{% trans 'Furniture' %}</a></li>#}
    {#                            <li><a href="listing-grid-3.html">{% trans 'Glasses' %}</a></li>#}
    {#                            <li><a href="listing-grid-1-full.html">{% trans 'Shoes' %}</a></li>#}
    {#                            <li><a href="listing-grid-1-full.html">{% trans 'Watches' %}</a></li>#}
    {#                        </ul>#}
    {#                    </div>#}
    {#                </div>#}
    {#                <div class="col-lg-3 col-md-6">#}
    {#                    <h3 data-bs-target="#collapse_3">{% trans 'Contacts' %}</h3>#}
    {#                    <div class="collapse dont-collapse-sm contacts" id="collapse_3">#}
    {#                        <ul>#}
    {#                            <li><i class="ti-home"></i>{% trans "97845 Baker st. 567<br>Los Angeles - US" %}</li>#}
    {#                            <li><i class="ti-home"></i>{% trans "97845 Baker st. 567<br>Los Angeles - US" %}</li>#}
    {#                            <li><i class="ti-headphone-alt"></i>+94 423-23-221</li>#}
    {#                            <li><i class="ti-email"></i><a href="#0">{% trans "info@allaia.com" %}</a></li>#}
    {#                            <li><i class="ti-email"></i><a href="#0">{% trans "info@allaia.com" %}</a></li>#}
    {#                        </ul>#}
    {#                    </div>#}
    {#                </div>#}
    {#                <div class="col-lg-3 col-md-6">#}
    {#                    <h3 data-bs-target="#collapse_4">{% trans 'Keep in touch' %}</h3>#}
    {#                    <div class="collapse dont-collapse-sm" id="collapse_4">#}
    {#                        <div id="newsletter">#}
    {#                            <div class="form-group">#}
    {#                                <input type="email" name="email_newsletter" id="email_newsletter" class="form-control"#}
    {#                                       placeholder="Your email">#}
    {#                                <button type="submit" id="submit-newsletter"><i class="ti-angle-double-right"></i>#}
    {#                                </button>#}
    {#                            </div>#}
    {#                        </div>#}
    {#                        <div class="follow_us">#}
    {#                            <h5>{% trans 'Follow Us' %}</h5>#}
    {#                            <ul>#}
    {#                                <li><a href="#0"><img#}
    {#                                        src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="#}
    {#                                        data-src="{% static "assets/img_for_shop/twitter_icon.svg" %}" alt=""#}
    {#                                        class="lazy"></a></li>#}
    {#                                <li><a href="#0"><img#}
    {#                                        src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="#}
    {#                                        data-src="{% static "assets/img_for_shop/facebook_icon.svg" %}" alt=""#}
    {#                                        class="lazy"></a></li>#}
    {#                                <li><a href="#0"><img#}
    {#                                        src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="#}
    {#                                        data-src="{% static "assets/img_for_shop/instagram_icon.svg" %}" alt=""#}
    {#                                        class="lazy"></a></li>#}
    {#                                <li><a href="#0"><img#}
    {#                                        src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="#}
    {#                                        data-src="{% static "assets/img_for_shop/youtube_icon.svg" %}" alt=""#}
    {#                                        class="lazy"></a></li>#}
    {#                            </ul>#}
    {#                        </div>#}
    {#                    </div>#}
    {#                </div>#}
    {#            </div>#}
    {#            <!-- /row-->#}
    {#            <hr>#}
    {#            <div class="row add_bottom_25">#}
    {#                <div class="col-lg-6">#}
    {#                    <ul class="footer-selector clearfix">#}
    {#                        <li>#}
    {#                            <div class="styled-select lang-selector">#}
    {#                                <select>#}
    {#                                    <option value="English" selected>{% trans 'English' %}</option>#}
    {#                                    <option value="French">{% trans 'French' %}</option>#}
    {#                                    <option value="Spanish">{% trans 'Spanish' %}</option>#}
    {#                                    <option value="Russian">{% trans 'Russian' %}</option>#}
    {#                                </select>#}
    {#                            </div>#}
    {#                        </li>#}
    {#                        <li>#}
    {#                            <div class="styled-select currency-selector">#}
    {#                                <select>#}
    {#                                    <option value="US Dollars" selected>{% trans 'US Dollars' %}</option>#}
    {#                                    <option value="Euro">{% trans 'Euro' %}</option>#}
    {#                                </select>#}
    {#                            </div>#}
    {#                        </li>#}
    {#                        <li><img#}
    {#                                src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="#}
    {#                                data-src="{% static "assets/img_for_shop/cards_all.svg" %}" alt="" width="198"#}
    {#                                height="30" class="lazy"></li>#}
    {#                    </ul>#}
    {#                </div>#}
    {#                <div class="col-lg-6">#}
    {#                    <ul class="additional_links">#}
    {#                        <li><a href="#0">{% trans 'Terms and conditions' %}</a></li>#}
    {#                        <li><a href="#0">{% trans 'Privacy' %}</a></li>#}
    {#                        <li><span>© 2021 Allaia</span></li>#}
    {#                    </ul>#}
    {#                </div>#}
    {#            </div>#}
    {#        </div>#}
    {#    </footer>#}
    <!--/footer-->

    <div id="toTop"></div><!-- Back to top button -->

    <div class="top_panel">
        <div class="container header_panel">
            <a href="#0" class="btn_close_top_panel"><i class="ti-close"></i></a>
            <label>{% trans '1 product added to cart' %}</label>
        </div>
        <!-- /header_panel -->
        <div class="item">
            <div class="container">
                <div class="row">
                    <div class="col-md-7">
                        <div class="item_panel">
                            <figure>
                                <img src="{% static "assets/img_for_shop/products/product_placeholder_square_small.jpg" %}"
                                     data-src="{% static "assets/img_for_shop/products/shoes/1.jpg" %}" class="lazy"
                                     alt="">
                            </figure>
                            <h4>{% trans instrument.name %}</h4>
                            <h4>{% trans instrument.name %}</h4>
                            <div class="price_panel">
                                <span class="new_price">${{ instrument.price }}</span>
                                <span class="percentage">-${{ instrument.percentage }}</span>
                                <span class="old_price">${{ instrument.old_price }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5 btn_panel">
                        <a href="/cart" class="btn_1 outline">{% trans 'View cart' %}</a>
                        <a href="/checkout" class="btn_1">{% trans 'Checkout' %}</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- /item -->
        <div class="container related">
            <h4>{% trans 'Who bought this product also bought' %}</h4>
            <div class="row">
                <div class="col-md-4">
                    <div class="item_panel">
                        <a href="#0">
                            <figure>
                                <img src="{% static "assets/img_for_shop/products/product_placeholder_square_small.jpg" %}"
                                     data-src="{% static "assets/img_for_shop/products/shoes/2.jpg" %}" alt=""
                                     class="lazy">
                            </figure>
                        </a>
                        <a href="#0">
                            <h5>{% trans "Armor Okwahn II" %}</h5>
                            <h5>{% trans "Armor Okwahn II" %}</h5>
                        </a>
                        <div class="price_panel"><span class="new_price">$90.00</span></div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="item_panel">
                        <a href="#0">
                            <figure>
                                <img src="{% static "assets/img_for_shop/products/product_placeholder_square_small.jpg" %}"
                                     data-src="{% static "assets/img_for_shop/products/shoes/3.jpg" %}" alt=""
                                     class="lazy">
                            </figure>
                        </a>
                        <a href="#0">
                            <h5>{% trans "Armor Air Wildwood ACG" %}</h5>
                            <h5>{% trans "Armor Air Wildwood ACG" %}</h5>
                        </a>
                        <div class="price_panel"><span class="new_price">$75.00</span><span
                                class="percentage">-20%</span> <span class="old_price">$155.00</span></div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="item_panel">
                        <a href="#0">
                            <figure>
                                <img src="{% static "assets/img_for_shop/products/product_placeholder_square_small.jpg" %}"
                                     data-src="{% static "assets/img_for_shop/products/shoes/4.jpg" %}" alt=""
                                     class="lazy">
                            </figure>
                        </a>
                        <a href="#0">
                            <h5>{% trans "Armor ACG React Terra" %}</h5>
                            <h5>{% trans "Armor ACG React Terra" %}</h5>
                        </a>
                        <div class="price_panel"><span class="new_price">$110.00</span></div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /related -->
    </div>
    <!-- /add_cart_panel -->

    <!-- Size modal -->
    <div class="modal " tabindex="-1" role="dialog" aria-labelledby="size-modal" id="size-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{% trans "Size guide" %}</h5>
                    <h5 class="modal-title">{% trans "Size guide" %}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Lorem ipsum dolor sit amet, et velit propriae invenire mea, ad nam alia intellegat. Aperiam
                        mediocrem rationibus nec te. Tation persecuti accommodare pro te. Vis et augue legere, vel
                        labitur habemus ocurreret ex.</p>
                    <div class="table-responsive">
                        <table class="table table-striped table-sm sizes">
                            <tbody>
                            <tr>
                                <th scope="row">{% trans "US Sizes" %}</th>
                                <th scope="row">{% trans "US Sizes" %}</th>
                                <td>6</td>
                                <td>{% trans "6,5" %}</td>
                                <td>{% trans "6,5" %}</td>
                                <td>7</td>
                                <td>{% trans "7,5" %}</td>
                                <td>{% trans "7,5" %}</td>
                                <td>8</td>
                                <td>{% trans "8,5" %}</td>
                                <td>{% trans "8,5" %}</td>
                                <td>9</td>
                                <td>{% trans "9,5" %}</td>
                                <td>{% trans "9,5" %}</td>
                                <td>10</td>
                                <td>{% trans "10,5" %}</td>
                                <td>{% trans "10,5" %}</td>
                            </tr>
                            <tr>
                                <th scope="row">{% trans "Euro Sizes" %}</th>
                                <th scope="row">{% trans "Euro Sizes" %}</th>
                                <td>39</td>
                                <td>39</td>
                                <td>40</td>
                                <td>{% trans "40-41" %}</td>
                                <td>{% trans "40-41" %}</td>
                                <td>41</td>
                                <td>{% trans "41-42" %}</td>
                                <td>{% trans "41-42" %}</td>
                                <td>42</td>
                                <td>{% trans "42-43" %}</td>
                                <td>{% trans "42-43" %}</td>
                                <td>43</td>
                                <td>{% trans "43-44" %}</td>
                                <td>{% trans "43-44" %}</td>
                            </tr>
                            <tr>
                                <th scope="row">{% trans "UK Sizes" %}</th>
                                <th scope="row">{% trans "UK Sizes" %}</th>
                                <td>{% trans "5,5" %}</td>
                                <td>{% trans "5,5" %}</td>
                                <td>6</td>
                                <td>{% trans "6,5" %}</td>
                                <td>{% trans "6,5" %}</td>
                                <td>7</td>
                                <td>{% trans "7,5" %}</td>
                                <td>{% trans "7,5" %}</td>
                                <td>8</td>
                                <td>{% trans "8,5" %}</td>
                                <td>{% trans "8,5" %}</td>
                                <td>9</td>
                                <td>{% trans "9,5" %}</td>
                                <td>{% trans "9,5" %}</td>
                                <td>10</td>
                            </tr>
                            <tr>
                                <th scope="row">{% trans "Inches" %}</th>
                                <th scope="row">{% trans "Inches" %}</th>
                                <td>{% trans "9.25" %}</td>
                                <td>{% trans "9.25" %}</td>
                                <td>{% trans "9.5" %}</td>
                                <td>{% trans "9.5" %}</td>
                                <td>{% trans "9.625" %}</td>
                                <td>{% trans "9.625" %}</td>
                                <td>{% trans "9.75" %}</td>
                                <td>{% trans "9.75" %}</td>
                                <td>{% trans "9.9375" %}</td>
                                <td>{% trans "9.9375" %}</td>
                                <td>{% trans "10.125" %}</td>
                                <td>{% trans "10.125" %}</td>
                                <td>{% trans "10.25" %}</td>
                                <td>{% trans "10.25" %}</td>
                                <td>{% trans "10.5" %}</td>
                                <td>{% trans "10.5" %}</td>
                                <td>{% trans "10.625" %}</td>
                                <td>{% trans "10.625" %}</td>
                                <td>{% trans "10.75" %}</td>
                                <td>{% trans "10.75" %}</td>
                            </tr>
                            <tr>
                                <th scope="row">CM</th>
                                <td>{% trans "23,5" %}</td>
                                <td>{% trans "23,5" %}</td>
                                <td>{% trans "24,1" %}</td>
                                <td>{% trans "24,1" %}</td>
                                <td>{% trans "24,4" %}</td>
                                <td>{% trans "24,4" %}</td>
                                <td>{% trans "24,8" %}</td>
                                <td>{% trans "24,8" %}</td>
                                <td>{% trans "25,4" %}</td>
                                <td>{% trans "25,4" %}</td>
                                <td>{% trans "25,7" %}</td>
                                <td>{% trans "25,7" %}</td>
                                <td>26</td>
                                <td>{% trans "26,7" %}</td>
                                <td>{% trans "26,7" %}</td>
                                <td>27</td>
                                <td>{% trans "27,3" %}</td>
                                <td>{% trans "27,3" %}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- /table -->
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block foot_link %}
    <!-- COMMON SCRIPTS -->
    <script src="{% static "assets/js_for_shop/common_scripts.min.js" %}"></script>
    <script src="{% static "assets/js_for_shop/main.js" %}"></script>

    <!-- SPECIFIC SCRIPTS -->
    <script src="{% static "assets/js_for_shop/carousel_with_thumbs.js" %}"></script>

    {% if model_url != "" %}
        <script type="text/javascript" src="{% static "assets/js_for_model/three.js" %}"></script>
        <script type="text/javascript" src="{% static "assets/js_for_model/GLTFLoader.js" %}"></script>
        <script type="text/javascript" src="{% static "assets/js_for_model/DDSLoader.js" %}"></script>
        <script type="text/javascript"
                src="{% static "assets/js_for_model/TrackballControls_with_range.js" %}"></script>
        <script type="text/javascript" src="{% static "assets/js_for_model/Detector.js" %}"></script>
        <script>
            var model_url = String({{ model_url |safe}});
            console.log("model url:", model_url);
            $(".slider-two").ready(function () {
                $(".item").click(function () {
                    if ($(".show-controls").css("display") === "none") {
                    } else {
                        $(".show3D").click();
                    }
                });
            });


            $(".show3D").click(function () {
                console.log("youwu", $(".model-zoom-in"));
                let img = $("#3d-icon");
                if (img.attr("src") === "{% static "assets/img_for_shop/3d-icon-close.jpg" %}") {
                    $(".show-controls").toggle("wrapper-hidden");
                    $("#3d-icon").attr('src', "{% static "assets/img_for_shop/3d-icon.png" %}");
                    $(".progress").attr("style", "display:none;position:absolute;width:95%;height: 100%;");
                } else {
                    $(".show-controls").toggle("wrapper-hidden");
                    $("#3d-icon").attr('src', "{% static "assets/img_for_shop/3d-icon-close.jpg" %}");
                    $(".progress").attr("style", "display:block;position:absolute;width:95%;height: 100%;");
                }
            });
        </script>
        <script type="text/javascript" src="{% static "assets/js_for_model/model_loader_detail2.js" %}"></script>

    {% else %}
    {% endif %}

    <!-- 需要修复main 的button错误-->
    <script>

        $(".main").style = "margin-bottom: 0px;";

        qtySelectors();

        function qtySelectors() {
            // Change number inputs to JS ones, similar to ajax cart but without API integration.
            // Make sure to add the existing name and id to the new input element
            var numInputs = $('input[type="number"]');
            if (numInputs.length) {
                numInputs.each(function () {
                    var $el = $(this),
                        currentQty = $el.val(),
                        inputName = $el.attr('name'),
                        inputId = $el.attr('id');

                    var itemAdd = currentQty + 1,
                        itemMinus = currentQty - 1,
                        itemQty = currentQty;

                    var source = $("#JsQty").html(),
                        template = Handlebars.compile(source),
                        data = {
                            id: $el.data('id'),
                            itemQty: itemQty,
                            itemAdd: itemAdd,
                            itemMinus: itemMinus,
                            inputName: inputName,
                            inputId: inputId
                        };

                    // Append new quantity selector then remove original
                    $el.after(template(data)).remove();
                });
            }
        }

        // Setup listeners to add/subtract from the input
        $('.js-qty__adjust').on('click', function () {
            var $el = $(this),
                id = $el.data('id'),
                $qtySelector = $el.siblings('.js-qty__num'),
                qty = parseInt($qtySelector.val().replace(/\D/g, ''));

            qty = validateQty(qty);

            // Add or subtract from the current quantity
            if ($el.hasClass('js-qty__adjust--plus')) {
                qty += 1;
                console.log(qty);
                {#updatePricingQty(qty);#}
            } else {
                qty -= 1;
                if (qty <= 1) qty = 1;
                {#updatePricingQty(qty);#}
            }

            // Update the input's number
            $qtySelector.val(qty);
        });

        function validateQty(qty) {
            if ((parseFloat(qty) === parseInt(qty)) && !isNaN(qty)) {
                // We have a valid number!
            } else {
                // Not a number. Default to 1.
                qty = 1;
            }
            return qty;
        }

        $(".underline_scale").click(function (e) {
            $(".underline_scale").removeClass("active");
            this.className = "underline_scale active";
        });

        $('.btn-addwhlist').on('click', function () {
            $.ajax({
                url: "/api/add_wishlist/",
                method: 'POST',
                data: {
                    instrument_id: this.id.split("__")[1]
                },
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                success: function (data) {
                    let res = data['code'];
                    if (res === 100) {
                        setTimeout(function () {
                            let hulla = new hullabaloo();
                            hulla.send("The instrument is already in your wishlist!", "warning");
                        }, 300);
                    } else if (res === 200) {
                        setTimeout(function () {
                            let hulla = new hullabaloo();
                            hulla.send("Add successfully!", "success");
                        }, 300);
                    } else if (res === 300) {
                        alert("Error!")
                    } else if (res === 400) {
                        window.location.href = "{% url 'accounts:log_in' %}"
                    }

                },
                error: function () {
                    alert('Error! Check console!');
                }

            })
        });

        $('.related-add-wishlist').on('click', function () {
            $.ajax({
                url: "/api/add_wishlist/",
                method: 'POST',
                data: {
                    instrument_id: this.id.split("__")[1]
                },
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                success: function (data) {
                    let res = data['code'];
                    if (res === 100) {
                        setTimeout(function () {
                            let hulla = new hullabaloo();
                            hulla.send("The instrument is already in your wishlist!", "warning");
                        }, 300);
                    } else if (res === 200) {
                        setTimeout(function () {
                            let hulla = new hullabaloo();
                            hulla.send("Add successfully!", "success");
                        }, 300);
                    } else if (res === 300) {
                        alert("Error!")
                    } else if (res === 400) {
                        window.location.href = "{% url 'accounts:log_in' %}"
                    }

                },
                error: function () {
                    alert('Error! Check console!');
                }

            })
        });

        $('.related-add-cart').on('click', function () {
            $.ajax({
                url: "/api/add_cart/",
                method: 'POST',
                data: {
                    instrument_id: this.id.split("__")[1],
                    count: $(this).prev().find('input').val(),
                },
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                success: function (data) {
                    let res = data['code'];
                    if (res === 100) {
                        setTimeout(function () {
                            let hulla = new hullabaloo();
                            hulla.send("The instrument is already in your cart!", "warning");
                        }, 300);
                    } else if (res === 200) {
                        $.ajax({
                            url: "#",
                            method: "GET",
                            success: function (res) {
                                $('#shopping-cart').html($(res).find('#shopping-cart')[0].innerHTML);
                                activateMiniCart();
                                activateDeleteCart();
                                update_total_money();
                            }
                        });
                        setTimeout(function () {
                            let hulla = new hullabaloo();
                            hulla.send("Add successfully!", "success");
                        }, 300);
                    } else if (res === 300) {
                        alert("Error!")
                    } else if (res === 400) {
                        window.location.href = "{% url 'accounts:log_in' %}"
                    }

                },
                error: function () {
                    alert('Error! Check console!');
                }

            })
        });

    </script>
{% endblock %}
